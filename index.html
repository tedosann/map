<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>USS Sperry WWII Route</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body, html {
            height: 100vh;
            margin: 0;
            padding: 0;
        }
        #map {
            height: 100vh;
            width: 100%;
        }
    </style>
</head>
<body>
<div id="map"></div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const map = L.map('map', {
        center: [20, 180],
        zoom: 3,
        worldCopyJump: true
    });

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    const route = [
        [40.7003, -73.9721], [32.2949, -64.783], [40.6782, -73.9442], [36.8508, -76.2859],
        [8.9824, -79.5199], [33.7325, -118.2794], [21.345, -157.95], [11.34, 162.33],
        [7.0, 150.0], [13.4443, 144.7937], [10.0167, 139.7833], [20.5833, 122.25],
        [10.34599, 107.08426], [10.776264, 106.694936], [12.0086, 109.2177],
        [22.3193, 114.1694], [19.5664, 109.9497], [23.1291, 113.2644], [23.3541, 116.6819],
        [10.0167, 139.7833], [36.2048, 138.2529], [35.6764, 139.65], [24.7481, 141.2906],
        [24.75028, 141.28889], [32.7503, 129.8777], [24.70965, 124.38848], [25.8281, 131.2311],
        [28.2667, 129.35], [26.2124, 127.6792], [10.9833, 125.0333], [39.275, 141.88],
        [34.739, 139.3986], [34.6901, 135.1955], [34.8833, 139.4333], [35.1815, 136.9066],
        [34.7108, 137.726], [34.3853, 132.4553], [32.7503, 129.8777], [35.6764, 139.65],
        [35.1333, 139.4833], [35.4437, 139.638], [35.2819, 139.6725], [35.375, 139.75],
        [11.34, 162.33], [34.226, 135.1675], [31.5966, 130.5571], [33.1594, 129.7222]
    ];

    // Draw route and handle antimeridian jump
    for (let i = 0; i < route.length - 1; i++) {
        const [lat1, lng1] = route[i];
        const [lat2, lng2] = route[i + 1];
        const diff = Math.abs(lng2 - lng1);

        if (diff > 180) {
            // Split line into two to avoid wrapping
            const midLng1 = lng1 < 0 ? 180 : -180;
            const midLng2 = lng2 < 0 ? 180 : -180;

            L.polyline([[lat1, lng1], [lat1, midLng1]], { color: 'blue' }).addTo(map);
            L.polyline([[lat2, midLng2], [lat2, lng2]], { color: 'blue' }).addTo(map);
        } else {
            L.polyline([[lat1, lng1], [lat2, lng2]], { color: 'blue' }).addTo(map);
        }
    }

    // Add markers
    route.forEach(([lat, lng]) => {
        L.circleMarker([lat, lng], {
            radius: 4,
            color: 'red',
            fillColor: 'red',
            fillOpacity: 0.8
        }).addTo(map);
    });

    map.fitBounds(route, { padding: [50, 50] });
</script>
</body>
</html>
